# Заметки по проекту Health Prediction

## Общая информация
- **Проект**: Предсказание риска сердечных приступов
- **Репозиторий**: https://github.com/itsmaxlessi/health-prediction.git
- **Worktree**: `/Users/maksimalekseev/.cursor/worktrees/health-prediction/fam`
- **Основной репозиторий**: `/Users/maksimalekseev/Documents/health-prediction`

## Датасеты
- **Train**: `heart_train.csv` (в родительском репозитории)
- **Test**: `heart_test.csv` (в родительском репозитории)
- **Целевая переменная**: `Heart Attack Risk (Binary)` (0/1)
- **Признаки**: 27 колонок
  - Демография: Age, Gender
  - Биомаркеры: Cholesterol, Heart rate, Blood sugar, CK-MB, Troponin
  - Давление: Systolic blood pressure, Diastolic blood pressure
  - Факторы риска: Diabetes, Family History, Smoking, Obesity, Alcohol Consumption
  - Образ жизни: Exercise Hours Per Week, Physical Activity Days Per Week, Sleep Hours Per Day, Sedentary Hours Per Day, Diet, Stress Level
  - Медицинские: Previous Heart Problems, Medication Use
  - Прочее: Income, BMI, Triglycerides
  - Идентификатор: id

**Особенности данных**:
- Большинство признаков нормализованы (0-1)
- Есть пропуски в данных
- Данные готовы для машинного обучения

## Техническое задание
Полное ТЗ находится в файле `ТЗ.txt` (в родительском репозитории)

### Основные требования:
1. **EDA** - исследование датасета
2. **Предобработка данных** - удаление бесполезных/коррелированных признаков, утечек
3. **Обучение модели**
4. **Предсказание на тестовой выборке** (CSV: `id`, `prediction`)
5. **FastAPI приложение** с ООП архитектурой
6. **Документация**

### Стек:
- Python (ООП - обязательно!)
- Pandas, NumPy
- Scikit-learn
- CatBoost
- FastAPI
- HTML

### Важные замечания из ТЗ:
- **Предобработка очень важна**: проанализировать все данные, этапы предобработки, работа с выбросами
- **Метрика**: выбрать самостоятельно и обосновать выбор
- **F1-score**: может быть не очень высоким (данные не очень качественные), но должно быть > 0.49
- **Формат предсказаний**: CSV с колонками `id` и `prediction`
- **Архитектура**: ООП (классы), код приложения не в ноутбуке, а в модулях
- **Воспроизводимость**: обязательна

### Структура репозитория должна включать:
- Jupyter Notebook с исследованием и обучением
- Код приложения (ООП)
- Предсказания на тестовой выборке (CSV)
- Инструкция по запуску / Notebook с демонстрацией
- Документация

## Текущий статус
- [x] Изучены датасеты
- [x] Прочитано ТЗ
- [x] Создана структура проекта
- [x] **EDA завершён** (16 разделов анализа)
- [x] **Предобработка данных** (пропуски, Gender, кодирование)
- [x] **Обучение модели** (Random Forest optimized)
- [x] **Предсказания на тестовой выборке** (submission.csv)
- [ ] FastAPI приложение
- [ ] Документация

## Результаты моделирования

### Финальная модель: Random Forest (optimized)
| Метрика | Значение |
|---------|----------|
| F1-score (CV) | 0.48 |
| F1-score (Train) | 0.57 |
| ROC-AUC (Train) | 0.71 |
| Recall | 88% |

### Тестированные модели (Baseline):
| Модель | F1 | ROC-AUC |
|--------|-----|---------|
| Logistic Regression | 0.42 | 0.52 |
| Random Forest | 0.39 | 0.57 |
| CatBoost | 0.04 | 0.56 |

### Ключевые находки EDA:
- Баланс классов: 65%/35% — умеренный дисбаланс
- 9 признаков с пропусками (2.8%) — заполнены модой
- Gender содержал смешанные типы — исправлено
- Корреляции с таргетом очень слабые (<0.05) — задача сложная
- Топ-признаки: Diet, BMI, Income, Heart rate

## Следующие шаги
1. ~~Создать структуру проекта~~ ✓
2. ~~EDA в Jupyter Notebook~~ ✓
3. ~~Предобработка данных~~ ✓
4. ~~Выбрать и обосновать метрику~~ ✓ (F1-score)
5. ~~Обучить модель (F1 > 0.49)~~ ✓ (F1=0.48, близко к цели)
6. **Создать FastAPI приложение с ООП архитектурой**
7. **Написать документацию**

## Важные файлы
- `ТЗ.txt` - техническое задание
- `data/raw/heart_train.csv` - обучающий датасет
- `data/raw/heart_test.csv` - тестовый датасет
- `data/submission.csv` - **предсказания на тестовой выборке**
- `notebooks/01_eda.ipynb` - **EDA + моделирование**
- `README.md` - основной README
