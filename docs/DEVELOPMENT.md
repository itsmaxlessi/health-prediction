# История разработки

> Документ описывает процесс разработки и ключевые решения проекта.

## Статус: ЗАВЕРШЁН

---

## Выполненные этапы

- [x] Изучение данных и ТЗ
- [x] Создание структуры проекта
- [x] EDA (разведочный анализ данных)
- [x] Предобработка данных
- [x] Обучение модели V1 (F1 = 0.48)
- [x] Улучшение модели V2 (F1 = 0.526)
- [x] FastAPI приложение с веб-интерфейсом
- [x] Документация

---

## Результаты моделирования

### Финальная модель: Random Forest V2

| Метрика | Значение |
|---------|----------|
| F1-score (CV) | **0.526** |
| Порог | 0.40 |
| ROC-AUC | 0.55 |

### Сравнение версий

| Версия | F1-score | Примечание |
|--------|----------|------------|
| V1 (baseline) | 0.48 | Стандартный порог 0.5 |
| V2 (optimized) | 0.526 | Порог 0.4 + Feature Engineering |

### Что улучшило результат

1. **Оптимизация порога** (0.5 → 0.4) — основной вклад (+5.9%)
2. **Feature Engineering** — 17 новых признаков
3. **Стекинг** не помог (0.475 < 0.526)

---

## Ключевые находки EDA

1. **Баланс классов:** 65% / 35% — умеренный дисбаланс
2. **Пропуски:** 9 признаков с пропусками (1-2%) — заполнены модой
3. **Корреляции:** Все признаки слабо коррелируют с таргетом (< 0.1)
4. **Gender:** Смешанные типы данных — исправлено
5. **Топ признаки:** Diet, BMI, Income, Heart rate

---

## Структура API

```
GET  /              → Веб-интерфейс (загрузка CSV)
POST /predict/csv   → Предсказание для CSV файла
POST /predict/patient → Предсказание для одного пациента
GET  /sample        → Скачать пример данных
GET  /health        → Статус API
GET  /model/info    → Информация о модели
```

---

## Файлы модели

- `models/model_v2.joblib` — обученная модель
- `models/threshold_v2.joblib` — порог 0.40
- `models/feature_engineering_v2.joblib` — информация о признаках

---

## Запуск

```bash
# Установка зависимостей
pip install -r requirements.txt

# Запуск API
python3 -m uvicorn src.api.main:app --host 0.0.0.0 --port 8000

# Открыть http://localhost:8000
```
